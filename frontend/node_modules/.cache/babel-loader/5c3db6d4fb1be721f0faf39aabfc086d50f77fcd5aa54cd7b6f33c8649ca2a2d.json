{"ast":null,"code":"import _regeneratorRuntime from\"/home/abhinav/ALL PROJECTS/attendancesystemiiitu/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/abhinav/ALL PROJECTS/attendancesystemiiitu/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/abhinav/ALL PROJECTS/attendancesystemiiitu/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import'./styles/Login.css';import{useRef,useState,useEffect}from'react';import useAuth from'../realm/useAuth';import NavBar from'../Navi';import{Link,Navigate}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Login(){var _useAuth=useAuth(),setAuth=_useAuth.setAuth;var _useAuth2=useAuth(),auth=_useAuth2.auth;var userRef=useRef();var errRef=useRef();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),pwd=_useState4[0],setPwd=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),success=_useState6[0],setSuccess=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),errMsg=_useState8[0],setErrMsg=_useState8[1];useEffect(function(){userRef.current.focus();},[]);useEffect(function(){setErrMsg('');},[user,pwd]);var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var body;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:e.preventDefault();body={\"username\":user,\"password\":pwd};fetch('/api/login',{method:'POST',headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(body)}).then(function(res){return res.json();}).then(function(res){console.log(res);if(res.message===\"Login Successfull\"){setSuccess(true);var role=res.user.role;var name=res.user.name;var studentId=res.user.studentId;var teacherId=res.user.teacherId;setAuth({user:user,pwd:pwd,role:role,name:name,studentId:studentId,teacherId:teacherId});}else{setSuccess(false);setErrMsg(res.message);}}).catch(function(err){if(!err.response.status===400)setErrMsg('Invalid Username or Password');else setErrMsg(\"Invalid Login\");errRef.current.focus();});setUser('');setPwd('');case 5:case\"end\":return _context.stop();}},_callee);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(_Fragment,{children:success?/*#__PURE__*/_jsxs(_Fragment,{children:[auth.role===1&&/*#__PURE__*/_jsx(Navigate,{to:\"/teacherPanel\"}),auth.role===0&&/*#__PURE__*/_jsx(Navigate,{to:\"/studentPanel\"}),auth.role===2&&/*#__PURE__*/_jsx(Navigate,{to:\"/adminPanel\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(NavBar,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"h1\",{align:\"center\",children:\"LOGIN\"}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"form\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"username\",children:\"Username:\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"username\",name:\"username\",ref:userRef,autoComplete:\"off\",onChange:function onChange(e){return setUser(e.target.value);},value:user,required:true}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"label\",{for:\"password\",children:\"Password\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"password\",name:\"password\",onChange:function onChange(e){return setPwd(e.target.value);},value:pwd,required:true}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",id:\"formloginbutton\",value:\"Login\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Don't have a account. \",/*#__PURE__*/_jsx(Link,{to:\"/signup\",children:\"Sign Up\"}),\" \"]})]}),errMsg!==''&&/*#__PURE__*/_jsx(\"div\",{className:\"errBox\",children:errMsg})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Link,{to:\"/courses\",children:/*#__PURE__*/_jsx(\"img\",{src:\"Foot.png\"})})})]})});}","map":{"version":3,"names":["useRef","useState","useEffect","useAuth","NavBar","Link","Navigate","Login","setAuth","auth","userRef","errRef","user","setUser","pwd","setPwd","success","setSuccess","errMsg","setErrMsg","current","focus","handleSubmit","e","preventDefault","body","fetch","method","headers","JSON","stringify","then","res","json","console","log","message","role","name","studentId","teacherId","catch","err","response","status","target","value"],"sources":["/home/abhinav/ALL PROJECTS/attendancesystemiiitu/frontend/src/pages/LoginPage.js"],"sourcesContent":["import './styles/Login.css'\nimport { useRef, useState, useEffect } from 'react';\nimport useAuth from '../realm/useAuth';\nimport NavBar from '../Navi';\nimport { Link, Navigate } from 'react-router-dom';\n\n\nexport default function Login() {\n\n  const { setAuth } = useAuth();\n  const { auth } = useAuth();\n  const userRef = useRef();\n  const errRef = useRef();\n\n  const [user, setUser] = useState('');\n  const [pwd, setPwd] = useState('');\n  const [success, setSuccess] = useState(false);\n  const [errMsg, setErrMsg] = useState('');\n\n  useEffect(() => {\n    userRef.current.focus();\n  }, [])\n\n  useEffect(() => {\n    setErrMsg('');\n  }, [user, pwd])\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    var body = {\n      \"username\": user,\n      \"password\": pwd\n    }\n    fetch('/api/login', {\n      method: 'POST',\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify(body)\n    })\n      .then(res => res.json())\n      .then((res) => {\n        console.log(res)\n        if (res.message === \"Login Successfull\") {\n          setSuccess(true);\n          const role = res.user.role\n          const name = res.user.name\n          const studentId = res.user.studentId\n          const teacherId = res.user.teacherId\n          setAuth({ user, pwd, role, name, studentId, teacherId })\n        }\n        else {\n          setSuccess(false);\n          setErrMsg(res.message);\n        }\n      })\n      .catch((err) => {\n        if (!err.response.status === 400)\n          setErrMsg('Invalid Username or Password');\n        else\n          setErrMsg(\"Invalid Login\")\n\n        errRef.current.focus();\n      })\n    setUser('');\n    setPwd('');\n  }\n\n  return (\n    <>\n\n      {success ? (\n        <>\n          {(auth.role===1)&&<Navigate to=\"/teacherPanel\" />}\n          {(auth.role===0)&&<Navigate to=\"/studentPanel\" />}\n          {(auth.role===2)&&<Navigate to=\"/adminPanel\"/>}\n        </>\n\n      ) : (\n        <>\n          <NavBar />\n          <div className=\"container\">\n            <h1 align='center'>LOGIN</h1>\n            <hr />\n            <form onSubmit={handleSubmit} className=\"form\">\n              <label for=\"username\">Username:</label><br />\n              <input type=\"text\"\n                id=\"username\"\n                name=\"username\"\n                ref={userRef}\n                autoComplete=\"off\"\n                onChange={(e) => setUser(e.target.value)}\n                value={user}\n                required\n              />\n\n              <br />\n              <label for=\"password\">Password</label><br />\n              <input type=\"text\"\n                id=\"password\"\n                name=\"password\"\n                onChange={(e) => setPwd(e.target.value)}\n                value={pwd}\n                required\n              />\n              <br />\n              <input type=\"submit\" id=\"formloginbutton\" value='Login' /><br/>\n              <p>Don't have a account. <Link to='/signup'>Sign Up</Link> </p>\n            </form>\n            {(errMsg !== '') && <div className='errBox'>{errMsg}</div>}\n          </div>\n          <div>\n            <Link to={\"/courses\"}>\n              <img src=\"Foot.png\" />\n            </Link>\n          </div>\n        </>\n\n      )}\n\n    </>\n\n  )\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}